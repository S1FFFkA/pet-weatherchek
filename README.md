# Weather Service

Сервис для получения и хранения данных о погоде с использованием внешних API и базы данных PostgreSQL.

## Описание

Приложение представляет собой HTTP-сервер на Go, который периодически собирает данные о температуре для заданного города через внешние API и сохраняет их в базу данных. Сервис предоставляет REST API для получения последних сохраненных данных о температуре.

## Функционал

- Периодический сбор данных о температуре через планировщик задач (каждые 10 секунд)
- Получение координат города через Geocoding API
- Получение текущей температуры через Open-Meteo API
- Сохранение данных о температуре в PostgreSQL
- HTTP API для получения последней температуры по городу
- Логирование HTTP-запросов через middleware

## Технологический стек

### Язык программирования
- Go 1.25.0

### Веб-фреймворк и роутинг
- Chi Router v5 - легковесный HTTP роутер для Go

### База данных
- PostgreSQL 18.0 - реляционная база данных для хранения метеорологических данных
- pgx/v5 - драйвер PostgreSQL для Go

### Планировщик задач
- gocron/v2 - библиотека для создания и управления периодическими задачами

### Внешние API
- Open-Meteo Geocoding API - получение координат по названию города
- Open-Meteo Forecast API - получение текущей температуры по координатам

### Инфраструктура
- Docker Compose - для запуска PostgreSQL в контейнере



## API Endpoints

### GET /{city}
Возвращает последнюю сохраненную температуру для указанного города.

**Пример запроса:**
```
GET /moscow
```

**Пример ответа:**
```json
{
  "name": "moscow",
  "timestamp": "2024-01-15T14:30:00Z",
  "temperature": 5.2
}
```

## Запуск проекта

### Требования
- Go 1.25.0 или выше
- Docker и Docker Compose

### Установка

1. Клонируйте репозиторий
2. Установите зависимости:
```bash
go mod download
```

3. Запустите PostgreSQL через Docker Compose:
```bash
docker-compose up -d
```

4. Создайте таблицу в базе данных:
```sql
CREATE TABLE reading (
    name VARCHAR(255),
    timestamp TIMESTAMP,
    temperature FLOAT
);
```

5. Запустите сервер:
```bash
go run cmd/server/main.go
```

Сервер будет доступен на порту `3000`.

## Конфигурация

В текущей версии параметры подключения к базе данных и настройки планировщика заданы в коде:
- Порт HTTP-сервера: `3000`
- Город для мониторинга: `moscow`
- Интервал обновления данных: `10 секунд`
- PostgreSQL: `localhost:54321`, база данных `weather`, пользователь `gleb`

